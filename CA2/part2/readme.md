# Class Assignment 2 Part 2

## Introduction

To Implement this class assignment the steps written in the devops_ca2_part2.pdf file were followed.
The goal of this assignment is to add the frontend plugin, copyJar task, and deleteWebpackFiles task to the gradle
project.
These changes will help in automating the frontend build process, copying the generated Jar file, and cleaning up the
webpack files.

## Part 1: Starting and configuring the project.

First, I will resume the first steps to get the project running.
Second, I will add the configurations given by professor Paulo Matos.
Third, I will configure the Frontend Plugin.

#### First: as given is the devops_ca2_part2.pdf

1. In your repository create a new branch called tut-basic-gradle. You should use this
   branch for this part of the assignment (do not forget to checkout this branch).
2. As instructed in the readme file of the tutorial, use https://start.spring.io to
   start a new gradle spring boot project with the following dependencies: Rest
   Repositories; Thymeleaf; JPA; H2.
3. Extract the generated zip file inside the folder ”CA2/Part2/” of your repository. We
   now have an ”empty” spring application that can be built using gradle. You can
   check the available gradle tasks by executing ./gradlew tasks.
4. Delete the src folder. We want to use the code from the basic tutorial...
5. Copy the src folder (and all its subfolders) from the basic folder of the tutorial into
      this new folder.
      Copy also the files webpack.config.js and package.json
      Delete the folder src/main/resources/static/built/ since this folder should be
      generated from the javascrit by the webpack tool.
6. You can now experiment with the application by using ./gradlew bootRun.
      Notice that the web page http://localhost:8080 is empty! This is because gradle is
      missing the plugin for dealing with the frontend code!

#### Second: as given by professor Paulo Matos
In the Employee.java class, change all javax.persistence imports to jakarta.persistence.

```java
import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.Id;
```

Add the package manager to the package.json file, before the scripts section:

```gradle
"packageManager": "npm@9.6.7",
```

NOTE: The java version should be 17.
The node and node_modules should be added to the git ignore.

#### Third:

1. Open the build.gradle file and add the plugin:

```gradle
 id "org.siouan.frontend-jdk17" version "8.0.0"
```

2. Configure the plugin in the same build.gradle file:

```gradle
 frontend {
nodeVersion = "16.20.2"
assembleScript = "run build"
cleanScript = "run clean"
checkScript = "run check"
}
```

3. Add the dependencies in the package.json file:

```gradle
"scripts": {
"webpack": "webpack",
"build": "npm run webpack",
"check": "echo Checking frontend",
"clean": "echo Cleaning frontend",
"lint": "echo Linting frontend",
"test": "echo Testing frontend"
},
```

4. Compile the project in the terminal(first navigate to the project folder):

```bash
./gradlew build
```

## Part 1: Adding the copyJar task

For this part of the assignment, a new task will be added to copy the generated Jar file. The steps to do so are:

1. Open the build.gradle file and add the task:

```gradle
task copyJar(type: Copy) {
	dependsOn jar
	from jar.archiveFile
	into 'dist'
}
```

2. Compile the project in the terminal(first navigate to the project folder):

```bash
./gradlew build
```

3. To run the task automatically when the build task is executed, add the following command:

```bash
./gradlew copyJar
```

## Part 2: Adding the deleteWebpackFiles task

For this part of the assignment, a new task will be added to delete the files generated by the webpack. The steps to do
so are:

1. Open the build.gradle file and add the task:

```gradle
task cleanWebpack(type: Delete) {
    delete 'src/main/resources/static/built'
}
```

2. Compile the project in the terminal(first navigate to the project folder):

```bash
./gradlew build
```

3. To run the task automatically when the clean task is executed, add the following command:

```bash
./gradlew cleanWebpack
```

## Summary

In this assignment, we have successfully added the frontend plugin, copyJar task, and deleteWebpackFiles task to the
gradle project. These changes will help in automating the frontend build process, copying the generated Jar file, and
cleaning up the webpack files. The project is now well-structured and ready for further development and deployment.


### Alternative Implementation using a different Build automation tool

o implement the project using Apache Ant instead of Gradle, you'll need to create an Ant build script (build.xml) that performs similar tasks to those outlined in the Gradle setup. Below is a basic outline of how you can achieve this:

#### Step 1: Setting Up the Project Structure
Create a new folder for your project.
Inside this folder, create the necessary subfolders and files:

```
- project_folder/
    - src/
        - main/
            - java/
            - resources/
            - web/
                - built/
    - build.xml
````  
#### Step 2: Writing the Ant Build Script (build.xml)
```xml  
      <project name="YourProject" default="build">

    <!-- Define properties -->
    <property name="src.dir" value="src"/>
    <property name="build.dir" value="build"/>
    <property name="dist.dir" value="${build.dir}/dist"/>
    <property name="jar.name" value="your-project.jar"/>

    <!-- Define tasks -->
    <target name="init">
        <mkdir dir="${build.dir}"/>
        <mkdir dir="${dist.dir}"/>
    </target>

    <!-- Compile Java code -->
    <target name="compile" depends="init">
        <javac srcdir="${src.dir}/main/java" destdir="${build.dir}" includeantruntime="false"/>
    </target>

    <!-- Package as JAR -->
    <target name="jar" depends="compile">
        <jar destfile="${dist.dir}/${jar.name}" basedir="${build.dir}">
            <manifest>
                <attribute name="Main-Class" value="your.package.MainClass"/>
            </manifest>
        </jar>
    </target>

    <!-- Clean -->
    <target name="clean">
        <delete dir="${build.dir}"/>
    </target>

    <!-- Clean Webpack Files -->
    <target name="clean-webpack">
        <delete dir="${src.dir}/main/web/built"/>
    </target>

    <!-- Copy JAR -->
    <target name="copy-jar" depends="jar">
        <copy file="${dist.dir}/${jar.name}" todir="dist"/>
    </target>

    <!-- Main build target -->
    <target name="build" depends="copy-jar, clean-webpack">
        <echo message="Build successful!"/>
    </target>

</project>
```

#### Step 3: Implementing Tasks
- init: Creates necessary directories for building.
- compile: Compiles Java source files.
- jar: Packages compiled classes into a JAR file.
- clean: Cleans build directory.
- clean-webpack: Cleans webpack-generated files.
- copy-jar: Copies the generated JAR file to the desired location.
- build: Main build target that depends on other tasks. This is where you can add further dependencies and actions as needed.
- Step 4: Running the Build
- To build your project using Ant, navigate to your project directory in the terminal and run:

```bash
ant build
```
This will execute the build target in the build.xml script, which will compile your Java code, package it into a JAR, clean up any webpack-generated files, and copy the JAR file to the dist directory.
It can also run individual tasks like compile, jar, clean, etc., as needed.

This Ant script provides basic functionality similar to what was achieved with Gradle.
It was not implemented.

